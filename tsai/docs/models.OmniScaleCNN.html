---

title: OmniScaleCNN


keywords: fastai
sidebar: home_sidebar

summary: "This is an unofficial PyTorch implementation by Ignacio Oguiza - oguiza@gmail.com based on:"
description: "This is an unofficial PyTorch implementation by Ignacio Oguiza - oguiza@gmail.com based on:"
nb_path: "nbs/109_models.OmniScaleCNN.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/109_models.OmniScaleCNN.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SampaddingConv1D_BN" class="doc_header"><code>class</code> <code>SampaddingConv1D_BN</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SampaddingConv1D_BN</code>(<strong><code>in_channels</code></strong>, <strong><code>out_channels</code></strong>, <strong><code>kernel_size</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="build_layer_with_layer_parameter" class="doc_header"><code>class</code> <code>build_layer_with_layer_parameter</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>build_layer_with_layer_parameter</code>(<strong><code>layer_parameters</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>formerly build_layer_with_layer_parameter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OmniScaleCNN" class="doc_header"><code>class</code> <code>OmniScaleCNN</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L59" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OmniScaleCNN</code>(<strong><code>c_in</code></strong>, <strong><code>c_out</code></strong>, <strong><code>seq_len</code></strong>, <strong><code>layers</code></strong>=<em><code>[1024, 229376]</code></em>, <strong><code>few_shot</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_Prime_number_in_a_range" class="doc_header"><code>get_Prime_number_in_a_range</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_Prime_number_in_a_range</code>(<strong><code>start</code></strong>, <strong><code>end</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_out_channel_number" class="doc_header"><code>get_out_channel_number</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_out_channel_number</code>(<strong><code>paramenter_layer</code></strong>, <strong><code>in_channel</code></strong>, <strong><code>prime_list</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_layer_parameter_list" class="doc_header"><code>generate_layer_parameter_list</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/models/OmniScaleCNN.py#L101" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_layer_parameter_list</code>(<strong><code>start</code></strong>, <strong><code>end</code></strong>, <strong><code>layers</code></strong>, <strong><code>in_channel</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">seq_len</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_in</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">(</span><span class="n">OmniScaleCNN</span><span class="p">,</span> <span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">OmniScaleCNN</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)(</span><span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">[</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_out</span><span class="p">])</span>
<span class="n">m</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OmniScaleCNN(
  (net): Sequential(
    (0): build_layer_with_layer_parameter(
      (conv_list): ModuleList(
        (0): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 0), value=0)
          (conv1d): Conv1d(3, 56, kernel_size=(1,), stride=(1,))
          (bn): BatchNorm1d(56, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 1), value=0)
          (conv1d): Conv1d(3, 56, kernel_size=(2,), stride=(1,))
          (bn): BatchNorm1d(56, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (2): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(1, 1), value=0)
          (conv1d): Conv1d(3, 56, kernel_size=(3,), stride=(1,))
          (bn): BatchNorm1d(56, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
    )
    (1): build_layer_with_layer_parameter(
      (conv_list): ModuleList(
        (0): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 0), value=0)
          (conv1d): Conv1d(168, 227, kernel_size=(1,), stride=(1,))
          (bn): BatchNorm1d(227, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 1), value=0)
          (conv1d): Conv1d(168, 227, kernel_size=(2,), stride=(1,))
          (bn): BatchNorm1d(227, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (2): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(1, 1), value=0)
          (conv1d): Conv1d(168, 227, kernel_size=(3,), stride=(1,))
          (bn): BatchNorm1d(227, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
    )
    (2): build_layer_with_layer_parameter(
      (conv_list): ModuleList(
        (0): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 0), value=0)
          (conv1d): Conv1d(681, 510, kernel_size=(1,), stride=(1,))
          (bn): BatchNorm1d(510, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): SampaddingConv1D_BN(
          (padding): ConstantPad1d(padding=(0, 1), value=0)
          (conv1d): Conv1d(681, 510, kernel_size=(2,), stride=(1,))
          (bn): BatchNorm1d(510, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
    )
  )
  (gap): GAP1d(
    (gap): AdaptiveAvgPool1d(output_size=1)
    (flatten): Flatten(full=False)
  )
  (hidden): Linear(in_features=1020, out_features=2, bias=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

